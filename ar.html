<!-- <script src="https://aframe.io/releases/0.9.2/aframe.min.js"></script>
<script src="https://cdn.rawgit.com/jeromeetienne/AR.js/1.7.5/aframe/build/aframe-ar.js"></script>
<script src='https://cdn.jsdelivr.net/npm/webxr-polyfill@latest/build/webxr-polyfill.js'></script>
<script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.0.1/dist/aframe-extras.min.js"></script> -->
<script src="js/aframe.min.js"></script>
<script src="js/aframe-ar.js"></script>
<script src='js/webxr-polyfill.js'></script>
<script src="js/aframe-extras.min.js"></script>
<script>
  var polyfill = new WebXRPolyfill();
  AFRAME.registerComponent('registerevents', {
    init: function () {
      var marker = this.el;
      marker.addEventListener('markerFound', function () {
        var markerId = marker.id;
        console.log('markerFound', markerId);
        // alert('markerFound:' + markerId)
        // TODO: Add your own code here to react to the marker being found.
        if (markerId !== 'kirby_ginga') {
          var markerEL = document.getElementById(markerId);
          var entityEl = document.createElement('a-entity');
          var url = "url(assets/cards/hearts/" + markerId + ".glb)"
          // entityEl.setAttribute('id', 'toy');
          entityEl.setAttribute('position', "0 0 -1");
          entityEl.setAttribute('scale', "0.7 1 0.7");
          entityEl.setAttribute('gltf-model', url);
          markerEL.appendChild(entityEl);
        } else {
          var markerEL = document.getElementById(markerId);
          var entityEl = document.createElement('a-entity');
          // entityEl.setAttribute('id', 'toy');
          entityEl.setAttribute('position', "0 0 -1.5");
          entityEl.setAttribute('rotation', "-90 90 -90");
          entityEl.setAttribute('gltf-model', "url(assets/kirby_ginga/scene.gltf)");
          entityEl.setAttribute('animation-mixer', { clip: '*', loop: 'once' });
          markerEL.appendChild(entityEl);
          entityEl.addEventListener('animation-finished', function () {
            // entityEl.removeAttribute('animation-mixer');
            entityEl.parentNode.removeChild(entityEl);
            var entityEl2 = document.createElement('a-entity');
            // entityEl2.setAttribute('id', 'toy2');
            entityEl2.setAttribute('position', "-1 0 -1.5");
            entityEl2.setAttribute('rotation', "-90 90 -90");
            entityEl2.setAttribute('gltf-model', "url(assets/kirby_ginga/scene.gltf)");
            entityEl2.setAttribute('animation-mixer', { clip: '*', loop: 'once' });
            markerEL.appendChild(entityEl2);
          }, { once: true });
        }
      });
      marker.addEventListener('markerLost', function () {
        var markerId = marker.id;
        console.log('markerLost', markerId);
        // 如果離開就移除該節點
        var e = document.getElementById(markerId);
        var child = e.lastElementChild;
        while (child) {
          e.removeChild(child);
          child = e.lastElementChild;
        }
        // TODO: Add your own code here to react to the marker being lost.
      });

    }
  });
</script>

<body style='margin : 0px; overflow: hidden;'>
  <a-scene embedded arjs='sourceType: webcam; debugUIEnabled: false;'>
    <a-marker id='1_hearts' type='pattern' url='assets/marker/hearts/pattern-1.patt' registerevents>
    </a-marker>
    <a-marker id='2_hearts' type='pattern' url='assets/marker/hearts/pattern-2.patt' registerevents>
    </a-marker>
    <a-marker id='3_hearts' type='pattern' url='assets/marker/hearts/pattern-3.patt' registerevents>
    </a-marker>
    <a-marker id='4_hearts' type='pattern' url='assets/marker/hearts/pattern-4.patt' registerevents>
    </a-marker>
    <a-marker id='5_hearts' type='pattern' url='assets/marker/hearts/pattern-5.patt' registerevents>
    </a-marker>
    <a-marker id='6_hearts' type='pattern' url='assets/marker/hearts/pattern-6.patt' registerevents>
    </a-marker>
    <a-marker id='7_hearts' type='pattern' url='assets/marker/hearts/pattern-7.patt' registerevents>
    </a-marker>
    <a-marker id='8_hearts' type='pattern' url='assets/marker/hearts/pattern-8.patt' registerevents>
    </a-marker>
    <a-marker id='9_hearts' type='pattern' url='assets/marker/hearts/pattern-9.patt' registerevents>
    </a-marker>
    <a-marker id='10_hearts' type='pattern' url='assets/marker/hearts/pattern-10.patt' registerevents>
    </a-marker>
    <a-marker id='11_hearts' type='pattern' url='assets/marker/hearts/pattern-11.patt' registerevents>
    </a-marker>
    <a-marker id='12_hearts' type='pattern' url='assets/marker/hearts/pattern-12.patt' registerevents>
    </a-marker>
    <a-marker id='13_hearts' type='pattern' url='assets/marker/hearts/pattern-13.patt' registerevents>
    </a-marker>
    <a-marker id='kirby_ginga' type='pattern' url='assets/marker/pattern-people.patt' registerevents>
    </a-marker>
  </a-scene>
</body>